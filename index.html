<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Sannin | Restaurante Libanés Auténtico Barcelona</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Playfair+Display:ital,wght@0,700;1,900&family=Plus+Jakarta+Sans:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --sannin-wood: #2d1b0e; 
            --sannin-terracotta: #b35a38; 
            --sannin-cream: #fdfaf5; 
            --sannin-gold: #c5a059;
        }
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: var(--sannin-cream); 
            color: var(--sannin-wood); 
            scroll-behavior: smooth; 
            overflow-x: hidden; 
        }

        .font-header { font-family: 'Cinzel', serif; }
        .font-accent { font-family: 'Playfair Display', serif; }
        .bg-paper { background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png'); }
        
        .hero-bg { 
            background: linear-gradient(rgba(45, 27, 14, 0.4), rgba(45, 27, 14, 0.6)), url('https://i.postimg.cc/c4j4SmHB/sannin1.jpg'); 
            background-size: cover; 
            background-position: center; 
        }
        
        .card-star { background-color: var(--sannin-wood); border-radius: 4px; box-shadow: 8px 8px 0px var(--sannin-gold); }
        @media (min-width: 768px) { .card-star { box-shadow: 15px 15px 0px var(--sannin-gold); } }
        
        .nav-glass { background: rgba(253, 250, 245, 0.98); backdrop-filter: blur(10px); border-bottom: 2px solid var(--sannin-wood); }
        .btn-action { background: var(--sannin-terracotta); transition: all 0.3s ease; border: 1px solid transparent; }
        
        .delivery-fab {
            width: 48px; height: 48px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden; background: white; border: 2px solid white;
        }
        @media (min-width: 768px) { .delivery-fab { width: 60px; height: 60px; } }
        .delivery-fab img { width: 100%; height: 100%; object-fit: cover; }

        .tabs-scroll {
            display: flex; overflow-x: auto; scroll-snap-type: x mandatory;
            scrollbar-width: none; -ms-overflow-style: none; gap: 0.5rem; padding-bottom: 0.5rem;
        }
        .tabs-scroll::-webkit-scrollbar { display: none; }
        .tabs-scroll button { flex-shrink: 0; scroll-snap-align: start; }

        .admin-edit-outline { outline: 2px dashed var(--sannin-gold); outline-offset: 4px; border-radius: 4px; background: rgba(197, 160, 89, 0.05); }
        .tab-active { background-color: var(--sannin-wood) !important; color: white !important; transform: translateY(-2px); }
        .lang-btn.active { color: var(--sannin-terracotta); font-weight: 800; border-bottom: 2px solid var(--sannin-terracotta); }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.8s ease-out forwards; }
        
        .loading-ring { width: 40px; height: 40px; border: 3px solid rgba(179, 90, 56, 0.1); border-radius: 50%; border-top-color: var(--sannin-terracotta); animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        #mobile-menu { transform: translateX(100%); transition: transform 0.3s ease-in-out; }
        #mobile-menu.open { transform: translateX(0); }
    </style>
</head>
<body class="bg-paper">

    <!-- BOUTONS DE LIVRAISON -->
    <div class="fixed bottom-4 right-4 md:bottom-8 md:right-8 z-[100] flex flex-col gap-3 md:gap-4">
        <a href="https://glovoapp.com/es/es/barcelona/sannin-barcelona" target="_blank" title="Glovo" class="delivery-fab">
            <img src="https://i.postimg.cc/CKQfZhBR/glovoim.png" alt="Glovo">
        </a>
        <a href="https://www.ubereats.com/es/store/restaurante-libanes-sannin-barcelona/QBgHbRlpSGiZWN_jz9Jsag" target="_blank" title="Uber Eats" class="delivery-fab">
            <img src="https://i.postimg.cc/jdFvbbvh/ubeat.jpg" alt="Uber Eats">
        </a>
        <a href="https://www.just-eat.es/restaurants-libanessannin/menu" target="_blank" title="Just Eat" class="delivery-fab">
            <img src="https://i.postimg.cc/Pq9PXS9Q/445647-Just-Eat-Logo-White-Secondary-Vertical-Stacked-On-Orange-RGB-2828cf-large-1664805776.png" alt="Just Eat">
        </a>
    </div>

    <!-- Menu Mobile -->
    <div id="mobile-menu" class="fixed inset-0 z-[150] bg-stone-900 flex flex-col p-8 lg:hidden text-white">
        <div class="flex justify-end mb-12">
            <button onclick="toggleMenu()" class="text-white text-2xl p-2"><i class="fas fa-times"></i></button>
        </div>
        <div class="flex flex-col gap-8 font-header text-2xl uppercase tracking-widest text-center">
            <a href="#menu" id="m-nav-menu" onclick="toggleMenu()">La Carta</a>
            <a href="#horarios" id="m-nav-horarios" onclick="toggleMenu()">Ubicación</a>
            <a href="tel:+34932850051" class="text-orange-400 font-sans font-bold">+34 932 85 00 51</a>
        </div>
    </div>

    <!-- Modals Administration -->
    <div id="login-modal" class="fixed inset-0 hidden z-[200] bg-stone-900/95 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white p-8 md:p-10 rounded-sm border-t-8 border-stone-800 w-full max-w-sm shadow-2xl text-stone-900">
            <h3 class="font-header text-2xl mb-8 text-center uppercase tracking-widest">Acceso Admin</h3>
            <div class="space-y-4">
                <input type="text" id="login-user" placeholder="USUARIO" class="w-full border-b border-stone-200 px-2 py-4 outline-none focus:border-orange-700 transition-all font-bold">
                <input type="password" id="login-pass" placeholder="CONTRASEÑA" class="w-full border-b border-stone-200 px-2 py-4 outline-none focus:border-orange-700 transition-all font-bold">
                <div id="login-error" class="hidden text-red-600 text-[10px] text-center font-bold uppercase py-2 tracking-widest">Error de acceso</div>
                <button onclick="window.attemptLogin()" class="w-full btn-action text-white py-5 rounded-sm font-bold text-xs uppercase tracking-[0.3em] shadow-xl">Entrar</button>
                <button onclick="window.closeLogin()" class="w-full py-2 text-[10px] font-bold uppercase text-stone-400 hover:text-stone-800 transition">Cancelar</button>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="fixed inset-0 hidden z-[200] bg-stone-900/95 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white p-8 md:p-10 rounded-sm border-t-8 border-emerald-600 w-full max-w-sm shadow-2xl text-stone-900">
            <h3 class="font-header text-2xl mb-8 text-center uppercase tracking-widest">Configuración</h3>
            <div class="space-y-4">
                <input type="text" id="new-user" placeholder="NUEVO USUARIO" class="w-full border-b border-stone-200 px-2 py-4 outline-none focus:border-emerald-600 transition-all font-bold">
                <input type="password" id="new-pass" placeholder="NUEVA CONTRASEÑA" class="w-full border-b border-stone-200 px-2 py-4 outline-none focus:border-emerald-600 transition-all font-bold">
                <button onclick="window.updateCredentials()" class="w-full bg-emerald-600 text-white py-5 rounded-sm font-bold text-xs uppercase tracking-[0.3em] shadow-xl">Actualizar Claves</button>
                <button onclick="window.closeSettings()" class="w-full py-2 text-[10px] font-bold uppercase text-stone-400">Volver</button>
            </div>
        </div>
    </div>

    <!-- Admin Bar -->
    <div id="admin-bar" class="fixed top-0 left-0 w-full hidden z-[100] py-2 px-4 md:px-6 bg-stone-900 text-white border-b border-stone-700 shadow-xl">
        <div class="max-w-7xl mx-auto flex justify-between items-center text-[10px] font-bold uppercase tracking-widest">
            <div class="flex items-center gap-4">
                <span class="bg-orange-700 px-3 py-1 rounded-sm">Modo Editor</span>
                <p id="current-admin-user" class="text-stone-400 hidden sm:block"></p>
                <button onclick="window.openSettings()" class="text-stone-500 hover:text-white transition px-2"><i class="fas fa-cog"></i></button>
            </div>
            <div class="flex gap-2 sm:gap-4 items-center">
                <button onclick="window.addItem(window.currentTab)" class="bg-stone-700 border border-stone-500 px-3 sm:px-4 py-2 hover:bg-stone-600 transition shadow-lg rounded-sm text-[9px] sm:text-[10px]"><i class="fas fa-plus mr-1"></i> Añadir Plato</button>
                <button id="save-btn" onclick="window.saveChanges()" class="bg-emerald-600 px-3 sm:px-5 py-2 hover:bg-emerald-500 transition shadow-lg rounded-sm text-[9px] sm:text-[10px]">Guardar</button>
                <button onclick="window.logoutAdmin()" class="bg-zinc-800 px-3 sm:px-5 py-2 hover:bg-stone-600 transition rounded-sm text-[9px] sm:text-[10px]">Salir</button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav id="main-nav" class="fixed w-full z-50 nav-glass transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 h-20 flex justify-between items-center">
            <div class="flex flex-col cursor-pointer group" onclick="window.scrollTo(0,0)">
                <span class="font-header text-xl sm:text-2xl md:text-3xl leading-none text-stone-900 tracking-tighter">SANNIN</span>
                <span class="text-[7px] sm:text-[8px] md:text-[9px] tracking-[0.2em] sm:tracking-[0.45em] text-orange-700 font-bold uppercase -mt-0.5 opacity-80" id="nav-brand-sub">Restaurante Libanés</span>
            </div>
            
            <div class="hidden lg:flex items-center space-x-8 xl:space-x-12 font-bold text-[10px] tracking-[0.25em] uppercase text-stone-500">
                <a href="#menu" id="nav-menu" class="hover:text-orange-700 transition">La Carta</a>
                <a href="#horarios" id="nav-horarios" class="hover:text-orange-700 transition">Ubicación</a>
                <a href="tel:+34932850051" class="text-stone-900 border-l border-stone-200 pl-8 xl:pl-12 flex items-center gap-2 font-sans"><i class="fas fa-phone text-[8px] text-orange-700"></i> +34 932 85 00 51</a>
            </div>

            <div class="flex items-center gap-3 sm:gap-6">
                <div class="flex gap-1.5 sm:gap-4 text-[9px] sm:text-[10px] font-black text-stone-400">
                    <button onclick="window.setLang('es')" id="lang-es" class="lang-btn px-1">ES</button>
                    <button onclick="window.setLang('cat')" id="lang-cat" class="lang-btn px-1">CAT</button>
                    <button onclick="window.setLang('en')" id="lang-en" class="lang-btn px-1">EN</button>
                </div>
                <button onclick="toggleMenu()" class="lg:hidden text-stone-900 text-xl p-2"><i class="fas fa-bars"></i></button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-bg min-h-[80vh] flex items-center justify-center text-center px-4 pt-24 pb-12">
        <div class="max-w-4xl fade-in">
            <h1 class="font-header text-3xl sm:text-5xl md:text-7xl lg:text-8xl mb-6 text-white uppercase tracking-tighter leading-[1.1] sm:leading-[0.9]" id="hero-title">Sabor Auténtico <br><span class="font-accent italic text-orange-400 normal-case lowercase text-2xl sm:text-4xl md:text-6xl lg:text-7xl">de Beirut</span></h1>
            <div class="w-16 sm:w-20 h-0.5 bg-orange-400/50 mx-auto mb-8 sm:mb-10"></div>
            <p id="hero-sub" class="text-stone-200 text-xs sm:text-base md:text-lg lg:text-xl font-light tracking-[0.1em] sm:tracking-[0.2em] uppercase mb-10 sm:mb-12 max-w-xs sm:max-w-none mx-auto">Desde 1993 compartiendo cultura en Gràcia</p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                <a href="#menu" id="btn-explore" class="w-full sm:w-auto inline-block bg-white text-stone-900 px-8 sm:px-12 py-4 sm:py-5 font-bold text-[10px] sm:text-[11px] uppercase tracking-[0.2em] sm:tracking-[0.3em] hover:bg-orange-700 hover:text-white transition-all shadow-2xl rounded-sm">Explorar Menú</a>
                <a href="https://maps.app.goo.gl/zLFLWrPkCFfXhnXY7" target="_blank" id="btn-how-to" class="w-full sm:w-auto inline-block border border-white/30 text-white px-8 sm:px-12 py-4 sm:py-5 font-bold text-[10px] sm:text-[11px] uppercase tracking-[0.2em] sm:tracking-[0.3em] hover:bg-white/10 transition-all rounded-sm">Cómo llegar</a>
            </div>
        </div>
    </section>

    <!-- Menu Section -->
    <section id="menu" class="py-12 sm:py-24 lg:py-32 px-4 min-h-screen">
        <div class="max-w-7xl mx-auto">
            <div id="loading-spinner" class="text-center py-20 sm:py-32">
                <div class="loading-ring mx-auto mb-6"></div>
                <p id="txt-loading" class="font-header uppercase text-[10px] tracking-widest opacity-40">Preparando delicias...</p>
            </div>
            <div id="menu-content" class="hidden grid grid-cols-1 lg:grid-cols-12 gap-12 lg:gap-16 xl:gap-20 fade-in">
                <div class="lg:col-span-4 order-2 lg:order-1">
                    <div class="card-star p-6 sm:p-8 md:p-10 lg:sticky lg:top-32">
                        <div class="flex justify-between items-start mb-8 sm:mb-12 border-b border-white/10 pb-6">
                            <h2 class="font-header text-xl sm:text-2xl md:text-3xl text-white uppercase leading-tight" id="txt-stars-title">Sugerencias <br><span class="text-orange-400 italic font-accent lowercase text-lg sm:text-xl md:text-2xl normal-case">del chef</span></h2>
                        </div>
                        <div class="space-y-8 sm:space-y-12" id="estrellas-list"></div>
                    </div>
                </div>

                <div class="lg:col-span-8 order-1 lg:order-2">
                    <div class="mb-8 sm:mb-12 border-b border-stone-200">
                        <div class="tabs-scroll pb-2" id="tabs-container">
                            <button onclick="changeTab('vegetales')" class="px-4 sm:px-6 py-3 font-bold text-[9px] sm:text-[10px] tracking-widest uppercase transition-all tab-active whitespace-nowrap" id="tab-vegetales">VEGETALES</button>
                            <button onclick="changeTab('empanadillas')" class="px-4 sm:px-6 py-3 font-bold text-[9px] sm:text-[10px] tracking-widest uppercase transition-all whitespace-nowrap" id="tab-empanadillas">EMPANADILLAS</button>
                            <button onclick="changeTab('combinados')" class="px-4 sm:px-6 py-3 font-bold text-[9px] sm:text-[10px] tracking-widest uppercase transition-all whitespace-nowrap" id="tab-combinados">COMBINADOS</button>
                            <button onclick="changeTab('couscous')" class="px-4 sm:px-6 py-3 font-bold text-[9px] sm:text-[10px] tracking-widest uppercase transition-all whitespace-nowrap" id="tab-couscous">COUS-COUS</button>
                            <button onclick="changeTab('otros')" class="px-4 sm:px-6 py-3 font-bold text-[9px] sm:text-[10px] tracking-widest uppercase transition-all whitespace-nowrap" id="tab-otros">OTROS</button>
                            <button onclick="changeTab('postres')" class="px-4 sm:px-6 py-3 font-bold text-[9px] sm:text-[10px] tracking-widest uppercase transition-all whitespace-nowrap" id="tab-postres">POSTRES</button>
                            <button onclick="changeTab('bebidas')" class="px-4 sm:px-6 py-3 font-bold text-[9px] sm:text-[10px] tracking-widest uppercase transition-all whitespace-nowrap" id="tab-bebidas">BEBIDAS</button>
                        </div>
                    </div>
                    <div class="grid gap-8 sm:gap-12" id="dynamic-menu"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Info Section -->
    <section id="horarios" class="py-16 sm:py-32 bg-stone-900 text-white">
        <div class="max-w-6xl mx-auto px-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12 sm:gap-16 lg:gap-20">
            <div>
                <h3 class="font-header text-lg sm:text-xl mb-6 sm:mb-10 uppercase text-orange-400 tracking-widest" id="txt-location-title">Ubicación</h3>
                <p class="text-stone-300 text-base sm:text-lg mb-6 sm:mb-8 leading-relaxed font-accent italic">Carrer de l'Encarnació, 44<br>08024 Barcelona (Vila de Gràcia)</p>
                <div class="flex gap-4">
                    <a href="tel:+34932850051" id="btn-call" class="btn-action flex-1 sm:flex-none text-center px-6 sm:px-8 py-3 rounded-sm font-bold text-[9px] sm:text-[10px] uppercase tracking-widest">Llamar</a>
                    <a href="https://maps.app.goo.gl/zLFLWrPkCFfXhnXY7" target="_blank" id="btn-map" class="border border-stone-700 flex-1 sm:flex-none text-center px-6 sm:px-8 py-3 rounded-sm font-bold text-[9px] sm:text-[10px] uppercase tracking-widest hover:bg-white/10 transition">Mapa</a>
                </div>
            </div>
            <div>
                <h3 id="txt-horarios-title" class="font-header text-lg sm:text-xl mb-6 sm:mb-10 uppercase text-orange-400 tracking-widest">Horarios</h3>
                <div class="space-y-4 text-stone-300 font-bold uppercase text-[9px] sm:text-[10px] tracking-[0.1em] sm:tracking-[0.2em]">
                    <div class="flex justify-between border-b border-stone-800 pb-4"><span id="txt-days">Lunes - Domingo</span><span class="text-white">13:00 – 23:00</span></div>
                    <p class="text-[8px] sm:text-[9px] text-stone-500 mt-4 normal-case italic" id="txt-open-always">Abierto todos los días de la semana.</p>
                </div>
            </div>
            <div class="lg:col-span-1">
                <h3 class="font-header text-lg sm:text-xl mb-6 sm:mb-10 uppercase text-orange-400 tracking-widest" id="txt-delivery-title">A domicilio</h3>
                <p class="text-stone-400 text-xs sm:text-sm leading-relaxed mb-6" id="txt-delivery-desc">Disfruta de lo mejor del Líbano en tu casa. Reparto disponible en Gràcia y barrios colindantes.</p>
                <div class="flex items-center gap-4 text-orange-400 font-bold">
                    <i class="fas fa-motorcycle text-xl sm:text-2xl"></i>
                    <span class="text-[10px] sm:text-xs uppercase tracking-widest" id="txt-delivery-badge">Envío rápido y seguro</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contacto" class="py-16 sm:py-24 bg-black text-center relative overflow-hidden">
        <div class="mb-10 sm:mb-12 flex flex-col items-center px-4">
            <span class="font-header text-3xl sm:text-4xl text-white tracking-[0.2em]">SANNIN</span>
            <span class="text-[9px] sm:text-[10px] tracking-[0.5em] sm:tracking-[0.6em] text-orange-700 font-bold uppercase mt-2" id="footer-tagline">Barcelona</span>
        </div>
        <button onclick="window.openLogin()" id="owner-access-btn" class="text-[9px] text-stone-700 uppercase tracking-[0.4em] sm:tracking-[0.5em] font-black hover:text-stone-300 transition-colors py-3 sm:py-4 px-8 sm:px-10 border border-white/5 rounded-full">Acceso Propietario</button>
        <p class="mt-10 sm:mt-12 text-stone-800 text-[8px] uppercase tracking-widest px-4" id="txt-footer-rights">© 2026 Restaurante Sannin. Todos los derechos reservados.</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD7tNaCFZqG9TewVmDLbUw5io4i11n22X0",
            authDomain: "sannin-3c77c.firebaseapp.com",
            projectId: "sannin-3c77c",
            storageBucket: "sannin-3c77c.firebasestorage.app",
            messagingSenderId: "346283737443",
            appId: "1:346283737443:web:be4679473269e746d69356",
            measurementId: "G-L76CGYDR69"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = "sannin-restaurant-pro-v3";

        window.menuData = null;
        window.adminSettings = { user: "admin", pass: "sannin123" };
        window.currentTab = 'vegetales';
        window.isAdmin = false;
        window.currentLang = localStorage.getItem('sanninLang') || 'es';

        const i18n = {
            es: { sub: "Desde 1993 compartiendo cultura en Gràcia", masaT: "Cocina Tradicional", masaD: "Recetas familiares transmitidas por generaciones. Utilizamos ingredientes frescos y especias traídas directamente del Líbano.", hT: "Horarios", navMenu: "La Carta", navHorarios: "Ubicación", btnExplore: "Explorar Menú", starsTitle: "Sugerencias <br><span class='text-orange-400 italic font-accent lowercase text-2xl normal-case'>del chef</span>", loading: "Preparando delicias...", heroTitle: "Sabor Auténtico <br><span class='font-accent italic text-orange-400 normal-case lowercase text-3xl sm:text-4xl md:text-7xl'>de Beirut</span>", btnHow: "Cómo llegar", brandSub: "Restaurante Libanés", locTitle: "Ubicación", btnCall: "Llamar", btnMap: "Mapa", delTitle: "A domicilio", delDesc: "Disfruta de lo mejor del Líbano en tu casa. Reparto disponible en Gràcia y barrios colindantes.", delBadge: "Envío rápido e seguro", days: "Lunes - Domingo", openAlways: "Abierto todos los días de la semana.", artesanal: "Artesanal", owner: "Acceso Propietario", rights: "© 2026 Restaurante Sannin. Todos los derechos reservados.", catVeg: "VEGETALES", catEmp: "EMPANADILLAS", catCom: "COMBINADOS", catCou: "COUS-COUS", catOtr: "OTROS", catPos: "POSTRES", catBeb: "BEBIDAS" },
            cat: { sub: "Des de 1993 compartint cultura a Gràcia", masaT: "Cuina Tradicional", masaD: "Receptes familiars transmeses per generacions. Utilitzem ingredients frescos i espècies portades directament del Líban.", hT: "Horaris", navMenu: "La Carta", navHorarios: "Ubicació", btnExplore: "Explorar Menú", starsTitle: "Suggeriments <br><span class='text-orange-400 italic font-accent lowercase text-2xl normal-case'>del xef</span>", loading: "Preparant delícies...", heroTitle: "Sabor Autèntic <br><span class='font-accent italic text-orange-400 normal-case lowercase text-3xl sm:text-4xl md:text-7xl'>de Beirut</span>", btnHow: "Com arribar", brandSub: "Restaurant Libanès", locTitle: "Ubicació", btnCall: "Trucar", btnMap: "Mapa", delTitle: "A domicili", delDesc: "Gaudeix del millor del Líban a casa teva. Repartiment disponible a Gràcia i voltants.", delBadge: "Enviament ràpid i segur", days: "Dilluns - Diumenge", openAlways: "Obert tots els dies de la setmana.", artesanal: "Artesanal", owner: "Accés Propietari", rights: "© 2026 Restaurant Sannin. Tots els drets reservats.", catVeg: "VEGETALS", catEmp: "EMPANADILLES", catCom: "COMBINATS", catCou: "COUS-COUS", catOtr: "ALTRES", catPos: "POSTRES", catBeb: "BEGUDES" },
            en: { sub: "Sharing culture in Gràcia since 1993", masaT: "Traditional Kitchen", masaD: "Family recipes passed down through generations. We use fresh ingredients and spices brought directly from Lebanon.", hT: "Opening Hours", navMenu: "The Menu", navHorarios: "Location", btnExplore: "Explore Menu", starsTitle: "Chef's <br><span class='text-orange-400 italic font-accent lowercase text-2xl normal-case'>specials</span>", loading: "Loading delicacies...", heroTitle: "Authentic Taste <br><span class='font-accent italic text-orange-400 normal-case lowercase text-3xl sm:text-4xl md:text-7xl'>of Beirut</span>", btnHow: "How to get here", brandSub: "Lebanese Restaurant", locTitle: "Location", btnCall: "Call", btnMap: "Map", delTitle: "Delivery", delDesc: "Enjoy the best of Lebanon at home. Delivery available in Gràcia and surroundings.", delBadge: "Fast and safe delivery", days: "Monday - Sunday", openAlways: "Open every day of the week.", artesanal: "Handmade", owner: "Owner Access", rights: "© 2026 Sannin Restaurant. All rights reserved.", catVeg: "VEGETABLES", catEmp: "DUMPLINGS", catCom: "COMBINATION PLATES", catCou: "COUSCOUS", catOtr: "OTHERS", catPos: "DESSERTS", catBeb: "DRINKS" }
        };

        const defaultMenu = {
            estrellas: [ 
                { id: 1, name: "Mixto Especial Sannin", price: "18,40€", desc: { es: "Shawarma, homos, baba gagnuc, kebe, falafel y ensalada variada.", cat: "Shawarma, homos, baba gagnuc, kebe, falafel i amanida variada.", en: "Shawarma, homos, baba gagnuc, kebe, falafel and mixed salad." }, available: true },
                { id: 2, name: "Cous-Cous Pollo", price: "17,90€", desc: { es: "Pollo, calabacín, zanahoria, garbanzos y sémola fina.", cat: "Pollastre, pastanaga, cigrons i sèmola fina.", en: "Chicken, carrots, chickpeas and fine semolina." }, available: true },
                { id: 3, name: "Homos Lahme", price: "8,90€", desc: { es: "Crema de garbanzos con carne picada de ternera y piñones.", cat: "Crema de cigrons amb carn picada de vedella i pinyons.", en: "Chickpea cream with minced beef and pine nuts." }, available: true },
                { id: 4, name: "Warak Inab (Sugerencia)", price: "8,50€", desc: { es: "6 rollos de hojas de parra rellenas de arroz y verduras.", cat: "6 fulles de parra farcides d'arròs i verdures.", en: "6 stuffed vine leaves with rice and vegetables." }, available: true }
            ],
            vegetales: [ 
                { id: 5, name: "Plato de Humus", price: "7,90€", desc: { es: "Crema de garbanzos molidos con crema de sésamo y limón.", cat: "Crema de cigrons molts amb crema de sèsam i llimona.", en: "Mashed chickpeas with sesame cream and lemon." }, available: true },
                { id: 6, name: "Humus (Medio Plato)", price: "5,80€", desc: { es: "Ración individual de garbanzos molidos.", cat: "Ració individual de cigrons molts.", en: "Individual portion of mashed chickpeas." }, available: true },
                { id: 7, name: "Plato de Baba Gagnuc", price: "7,90€", desc: { es: "Berenjena asada con crema de sésamo, limón y aceite de oliva.", cat: "Albergínia escalivada amb crema de sèsam i llimona.", en: "Roasted eggplant with sesame cream and lemon." }, available: true },
                { id: 8, name: "Baba Gagnuc (Medio Plato)", price: "5,80€", desc: { es: "Ración individual de berenjena asada.", cat: "Ració individual d'albergínia escalivada.", en: "Individual portion of roasted eggplant." }, available: true },
                { id: 9, name: "Moussaka Vegetal con Arroz", price: "10,40€", desc: { es: "Garbanzos, pimientos, berenjena, calabacín y cebolla.", cat: "Cigrons, pebrots, albergínia, carbassó i ceba.", en: "Chickpeas, peppers, eggplant, zucchini and onion." }, available: true },
                { id: 10, name: "Ensalada de Barsakan", price: "9,40€", desc: { es: "Mezclum con tomate, pepino, queso de cabra y feta.", cat: "Mesclum amb tomàquet, pepino, formatge de cabra i feta.", en: "Mixed salad with tomato, cucumber, goat cheese and feta." }, available: true },
                { id: 11, name: "Plato de Tabule", price: "10,40€", desc: { es: "Ensalada de perejil, tomate, sémola de trigo y menta.", cat: "Amanida de julivert, tomàquet, sèmola de blat i menta.", en: "Parsley salad, tomato, wheat semolina and mint." }, available: true },
                { id: 12, name: "Plato Falafel con Ensalada", price: "10,50€", desc: { es: "6 Croquetas vegetales con salsa de yogur y ensalada.", cat: "6 Croquetes vegetals amb salsa de iogurt i amanida.", en: "6 Vegetable croquettes with yogurt sauce and salad." }, available: true },
                { id: 13, name: "Plato Mohamara", price: "7,90€", desc: { es: "Picada de nueces, pimientos y melaza de granada. Picante.", cat: "Picada de nous, pebrots i melassa de magrana. Picant.", en: "Walnut mince, peppers and pomegranate molasses. Spicy." }, available: true },
                { id: 14, name: "Plato de Magmus", price: "7,90€", desc: { es: "Escalivada de berenjena asada, pimientos y zumo de granada.", cat: "Escalivada d'albergínia rostida, pebrots i suc de magrana.", en: "Roasted eggplant escalivada, peppers and pomegranate juice." }, available: true }
            ],
            empanadillas: [
                { id: 15, name: "Fatayer Sabanec", price: "3,90€", desc: { es: "Empanadilla artesana de espinaca.", cat: "Empanadilha artesana d'espinacs.", en: "Handmade spinach pastry." }, available: true },
                { id: 16, name: "Kebe (Unidad)", price: "3,90€", desc: { es: "Croqueta de sémola de trigo rellena con carne picada.", cat: "Croqueta de sèmola de blat farcida amb carn picada.", en: "Wheat semolina croquette stuffed with minced meat." }, available: true }
            ],
            combinados: [
                { id: 17, name: "Combinado Xix tawuk", price: "16,40€", desc: { es: "Pollo adobado con humus, baba gagnuc y ensalada.", cat: "Pollastre adobat amb humus, baba gagnuc i amanida.", en: "Marinated chicken with humus, baba gagnuc and salad." }, available: true },
                { id: 18, name: "Combinado Sannin", price: "18,40€", desc: { es: "Cordero asado, humus, baba gagnuc, falafel, kebe y ensalada.", cat: "Xai rostir, humus, baba gagnuc, falafel, kebe i amanida.", en: "Roasted lamb, humus, baba gagnuc, falafel, kebe and salad." }, available: true },
                { id: 19, name: "Combinado Shawarma", price: "16,40€", desc: { es: "Cordero con humus, baba gagnuc y ensalada.", cat: "Xai amb humus, baba gagnuc i amanida.", en: "Lamb with humus, baba gagnuc and salad." }, available: true },
                { id: 20, name: "Combinado Vegetal", price: "15,90€", desc: { es: "Falafel, humus, baba gagnuc, warak inab y ensalada.", cat: "Falafel, humus, baba gagnuc, warak inab i amanida.", en: "Falafel, humus, baba gagnuc, warak inab and salad." }, available: true },
                { id: 21, name: "Combinado Kafta", price: "16,40€", desc: { es: "Ternera picada especiada, humus, baba gagnuc y ensalada.", cat: "Vedella picada amb humus, baba gagnuc i amanida.", en: "Minced beef with humus, baba gagnuc and salad." }, available: true },
                { id: 22, name: "Xix Tawuk Plato con Arroz", price: "11,90€", desc: { es: "Pollo a la plancha adobado con ajo y cilantro.", cat: "Pollastre a la planxa adobat amb all i julivert.", en: "Grilled chicken marinated with garlic and parsley." }, available: true },
                { id: 23, name: "Kafta Plato con Ensalada", price: "11,90€", desc: { es: "Ternera picada con especias a la plancha.", cat: "Vedella picada amb espècies a la planxa.", en: "Spiced minced beef grilled." }, available: true },
                { id: 24, name: "Kebe Plato con Ensalada", price: "11,90€", desc: { es: "3 croquetas de sémola rellenas con carne picada.", cat: "3 croquetes de sèmola farcides amb carn picada.", en: "3 semolina croquettes stuffed with minced meat." }, available: true },
                { id: 25, name: "Shawarma Plato con Ensalada", price: "11,90€", desc: { es: "Cordero asado a la libanesa con ensalada.", cat: "Xai rostir a la libanesa amb amanida.", en: "Lebanese-style roasted lamb with salad." }, available: true }
            ],
            couscous: [
                { id: 30, name: "Cous-Cous Pollo", price: "17,90€", desc: { es: "Pollo, verduras, garbanzos y sémola fina.", cat: "Pollastre, verdures, cigrons i sèmola fina.", en: "Chicken, vegetables, chickpeas and fine semolina." }, available: true },
                { id: 31, name: "Cous-Cous Vegetal", price: "15,90€", desc: { es: "Verduras variadas en caldo vegetal con sémola.", cat: "Verdures variades en brou vegetal amb sèmola.", en: "Mixed vegetables in vegetable broth with semolina." }, available: true }
            ],
            otros: [
                { id: 32, name: "Arayes Gibne", price: "9,90€", desc: { es: "Quesadilla de 5 quesos, tomate y cebolla.", cat: "Quesadilla de 5 formatges, tomàquet i ceba.", en: "5-cheese quesadilla, tomato and onion." }, available: true },
                { id: 33, name: "Patatas Bravas", price: "5,40€", desc: { es: "Patatas bravas caseras con salsa brava.", cat: "Patates braves casolanes amb salsa brava.", en: "Homemade spicy potatoes with brava sauce." }, available: true },
                { id: 34, name: "Jaiki", price: "7,90€", desc: { es: "Queso fresco con menta y pepino rallado.", cat: "Formatge fresc amb menta i cogombre ratllat.", en: "Fresh cheese with mint and grated cucumber." }, available: true },
                { id: 35, name: "Moussaka de Carne", price: "15,40€", desc: { es: "Pastel de ternera, berenjena y bechamel con arroz.", cat: "Pastís de vedella, albergínia i beixamel amb arròs.", en: "Beef, eggplant and bechamel pie with rice." }, available: true },
                { id: 36, name: "Pan de Pita (1 unidad)", price: "0,90€", desc: { es: "Pan libanés tradicional.", cat: "Pa libanès tradicional.", en: "Traditional Lebanese bread." }, available: true }
            ],
            postres: [
                { id: 37, name: "Baklava", price: "1,90€", desc: { es: "Hojaldre con pistachos, nueces y almíbar.", cat: "Pasta de full amb pistatxos, nous i almívar.", en: "Filo pastry with pistachios, walnuts and syrup." }, available: true },
                { id: 38, name: "Aish As-Saraya", price: "4,90€", desc: { es: "Tostadas en almíbar, crema de nata y pistachos.", cat: "Torrades en almívar, crema de nata i pistatxos.", en: "Toast in syrup, cream custard and pistachios." }, available: true },
                { id: 39, name: "Tamer", price: "1,90€", desc: { es: "Galleta con dátiles y sésamo.", cat: "Galeta amb dàtils i sèsam.", en: "Date and sesame cookie." }, available: true },
                { id: 40, name: "Barasik", price: "1,90€", desc: { es: "Galleta con sésamo y pistachos.", cat: "Galeta amb sèsam i pistatxos.", en: "Sesame and pistachio cookie." }, available: true }
            ],
            bebidas: [
                { id: 41, name: "Cerveza Almaza", price: "3,00€", desc: { es: "Cerveza libanesa de importación.", cat: "Cervesa libanesa d'importació.", en: "Imported Lebanese beer." }, available: true },
                { id: 42, name: "Vino Libanés (Botella)", price: "19,00€", desc: { es: "Vino del Valle de la Becá.", cat: "Vi de la Vall de la Becà.", en: "Wine from the Bekaa Valley." }, available: true },
                { id: 43, name: "Cava Brut de la Casa", price: "15,00€", desc: { es: "Botella de cava selección.", cat: "Ampolla de cava selecció.", en: "Bottle of selected cava." }, available: true },
                { id: 44, name: "Refrescos 0.33L", price: "2,50€", desc: { es: "Lata variada.", cat: "Llauna variada.", en: "Mixed can." }, available: true },
                { id: 45, name: "Agua 0.50L", price: "1,80€", desc: { es: "Botella mineral.", cat: "Ampolla mineral.", en: "Mineral bottle." }, available: true }
            ]
        };

        // On démarre avec le menu par défaut pour un affichage immédiat
        window.menuData = defaultMenu;

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // Sync Settings
                const sRef = doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'main');
                try {
                    const snap = await getDoc(sRef);
                    if (snap.exists()) window.adminSettings = snap.data();
                    else await setDoc(sRef, window.adminSettings);
                } catch(e) {}

                // Sync Menu
                const mRef = doc(db, 'artifacts', appId, 'public', 'data', 'menu', 'main');
                onSnapshot(mRef, (snap) => {
                    if (snap.exists()) {
                        window.menuData = snap.data().content;
                    }
                    // Qu'il y ait des données ou non sur Firebase, on affiche et on cache le spinner
                    render(); 
                    hideLoad();
                }, (error) => {
                    console.error("Firebase Sync Error:", error);
                    render(); hideLoad();
                });
            }
        });
        
        signInAnonymously(auth).catch(e => { render(); hideLoad(); });

        // Vérification de l'admin au chargement
        try {
            if (sessionStorage.getItem('sanninAdminAuth') === 'true') window.isAdmin = true;
        } catch(e) {}

        window.toggleMenu = () => { document.getElementById('mobile-menu').classList.toggle('open'); };
        window.setLang = (l) => { window.currentLang = l; localStorage.setItem('sanninLang', l); render(); };

        window.render = () => {
            if (!window.menuData) return;
            const t = i18n[window.currentLang];
            
            document.getElementById('hero-title').innerHTML = t.heroTitle;
            document.getElementById('hero-sub').innerText = t.sub;
            document.getElementById('nav-brand-sub').innerText = t.brandSub;
            document.getElementById('nav-menu').innerText = t.navMenu;
            document.getElementById('nav-horarios').innerText = t.navHorarios;
            document.getElementById('m-nav-menu').innerText = t.navMenu;
            document.getElementById('m-nav-horarios').innerText = t.navHorarios;
            document.getElementById('btn-explore').innerText = t.btnExplore;
            document.getElementById('btn-how-to').innerText = t.btnHow;
            document.getElementById('txt-stars-title').innerHTML = t.starsTitle;
            document.getElementById('txt-loading').innerText = t.loading;
            document.getElementById('txt-location-title').innerText = t.locTitle;
            document.getElementById('btn-call').innerText = t.btnCall;
            document.getElementById('btn-map').innerText = t.btnMap;
            document.getElementById('txt-horarios-title').innerText = t.hT;
            document.getElementById('txt-days').innerText = t.days;
            document.getElementById('txt-open-always').innerText = t.openAlways;
            document.getElementById('txt-delivery-title').innerText = t.delTitle;
            document.getElementById('txt-delivery-desc').innerText = t.delDesc;
            document.getElementById('txt-delivery-badge').innerText = t.delBadge;
            
            document.getElementById('tab-vegetales').innerText = t.catVeg;
            document.getElementById('tab-empanadillas').innerText = t.catEmp;
            document.getElementById('tab-combinados').innerText = t.catCom;
            document.getElementById('tab-couscous').innerText = t.catCou;
            document.getElementById('tab-otros').innerText = t.catOtr;
            document.getElementById('tab-postres').innerText = t.catPos;
            document.getElementById('tab-bebidas').innerText = t.catBeb;
            
            document.getElementById('txt-artesanal').innerText = t.artesanal;
            document.getElementById('txt-masa-title').innerText = t.masaT;
            document.getElementById('txt-masa-desc').innerText = t.masaD;
            document.getElementById('owner-access-btn').innerText = t.owner;
            document.getElementById('txt-footer-rights').innerText = t.rights;
            
            document.getElementById('estrellas-list').innerHTML = (window.menuData.estrellas || []).map(i => itemHtml(i, 'estrellas', true)).join('');
            document.getElementById('dynamic-menu').innerHTML = (window.menuData[window.currentTab] || []).map(i => itemHtml(i, window.currentTab, false)).join('');
            
            document.querySelectorAll('.lang-btn').forEach(b => b.classList.toggle('active', b.id === 'lang-' + window.currentLang));
            syncAdminUI();
        };

        function itemHtml(item, cat, isE) {
            if (!item.available && !window.isAdmin) return '';
            const ed = window.isAdmin ? 'contenteditable="true"' : '';
            const cl = window.isAdmin ? 'admin-edit-outline px-2' : '';
            const description = (typeof item.desc === 'object') ? (item.desc[window.currentLang] || item.desc['es']) : item.desc;

            if (isE) {
                return `<div class="${item.available ? '' : 'opacity-25'} mb-8"><div class="flex justify-between items-baseline ${cl}"><h4 onblur="window.upVal('${cat}', ${item.id}, 'name', this.innerText)" ${ed} class="font-bold text-white uppercase outline-none text-sm sm:text-base md:text-lg">${item.name}</h4><span class="text-orange-400 font-black ml-4 whitespace-nowrap text-sm md:text-base">${item.price}</span></div><p onblur="window.upVal('${cat}', ${item.id}, 'desc', this.innerText)" ${ed} class="text-stone-400 text-[10px] sm:text-xs italic leading-relaxed outline-none">${description}</p></div>`;
            } else {
                return `<div class="${item.available ? '' : 'opacity-25'} border-b border-stone-200 pb-6 sm:pb-8 md:pb-10 mb-6 sm:mb-8 md:mb-10"><div class="flex justify-between items-baseline ${cl}"><h4 onblur="window.upVal('${cat}', ${item.id}, 'name', this.innerText)" ${ed} class="font-header text-stone-900 text-base sm:text-lg md:text-xl outline-none">${item.name}</h4><span class="text-stone-900 font-black ml-6 whitespace-nowrap text-sm md:text-base">${item.price}</span></div><p onblur="window.upVal('${cat}', ${item.id}, 'desc', this.innerText)" ${ed} class="text-stone-500 text-[11px] sm:text-xs md:text-sm font-light italic leading-relaxed outline-none">${description}</p></div>`;
            }
        }

        window.changeTab = (c) => { 
            window.currentTab = c; 
            document.querySelectorAll('#tabs-container button').forEach(b => b.classList.remove('tab-active')); 
            const activeBtn = document.getElementById('tab-'+c);
            if(activeBtn) { activeBtn.classList.add('tab-active'); activeBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' }); }
            render(); 
        };
        
        window.upVal = (c, id, f, v) => { 
            const i = window.menuData[c].find(x => x.id === id); 
            if(i) {
                if (f === 'desc') { if (typeof i.desc !== 'object') i.desc = { es: i.desc, cat: i.desc, en: i.desc }; i.desc[window.currentLang] = v; }
                else { i[f] = v; }
            }
        };

        window.openLogin = () => document.getElementById('login-modal').classList.remove('hidden');
        window.closeLogin = () => document.getElementById('login-modal').classList.add('hidden');
        window.attemptLogin = () => { 
            const u = document.getElementById('login-user').value.trim();
            const p = document.getElementById('login-pass').value.trim();
            if (u === window.adminSettings.user && p === window.adminSettings.pass) { 
                window.isAdmin = true; 
                try { sessionStorage.setItem('sanninAdminAuth', 'true'); } catch(e) {}
                render(); 
                window.closeLogin(); 
            } else {
                document.getElementById('login-error').classList.remove('hidden');
            }
        };

        window.openSettings = () => { document.getElementById('new-user').value = window.adminSettings.user; document.getElementById('settings-modal').classList.remove('hidden'); };
        window.closeSettings = () => document.getElementById('settings-modal').classList.add('hidden');
        window.updateCredentials = async () => {
            const u = document.getElementById('new-user').value.trim();
            const p = document.getElementById('new-pass').value.trim();
            if(u && p) {
                window.adminSettings = { user: u, pass: p };
                await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'main'), window.adminSettings);
                alert("Claves actualizadas."); window.closeSettings(); render();
            }
        };

        window.saveChanges = async () => {
            const btn = document.getElementById('save-btn'); btn.innerText = "Guardando...";
            try { await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'menu', 'main'), { content: window.menuData }); alert("¡Menú guardado!"); } catch(e) { alert("Error."); } btn.innerText = "Guardar";
        };

        window.logoutAdmin = () => { window.isAdmin = false; try { sessionStorage.removeItem('sanninAdminAuth'); } catch(e) {} render(); };
        
        function syncAdminUI() { 
            const bar = document.getElementById('admin-bar');
            bar.classList.toggle('hidden', !window.isAdmin); 
            document.getElementById('main-nav').style.top = window.isAdmin ? (window.innerWidth < 640 ? '34px' : '40px') : '0';
            if(window.isAdmin) document.getElementById('current-admin-user').innerText = "HOLA, " + window.adminSettings.user;
        }

        window.addItem = (c) => {
            if(!window.menuData[c]) window.menuData[c] = [];
            const newItem = { id: Date.now(), name: "NUEVO PLATO", price: "0,00€", desc: { es: "Descripción...", cat: "Descripció...", en: "Description..." }, available: true };
            window.menuData[c].unshift(newItem);
            render();
        };

        function hideLoad() { 
            document.getElementById('loading-spinner').classList.add('hidden'); 
            document.getElementById('menu-content').classList.remove('hidden'); 
        }
        window.addEventListener('resize', syncAdminUI);
    </script>
</body>
</html>
